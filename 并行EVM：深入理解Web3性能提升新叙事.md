# 并行EVM：深入理解Web3性能提升新叙事

## TL;DR

## 1. 行业综述

### 1.1 历史沿革

区块链网络为个人和企业进行交易创造了一种新的、去中心化的信任基础。以比特币为代表的第一代区块链网络以分布式记账的方式开创了去中心化的电子货币交易新模式，革命性地开创了一个新时代。随后，以以太坊为代表的第二代区块链网络则充分发挥想象力，提出以分布式状态机的方式实现去中心化应用（dApp）。从那时起，区块链网络开启了它自己十几年飞速发展的历史，从Web3基础设施到以DeFi、NFT、社交网络和GameFi等为代表的各种赛道，诞生了无数或技术或商业模式的创新。行业的蓬勃发展需要不断吸引新用户参与去中心化应用的生态建设，吸引新用户反过来又对产品体验提出了更高的要求。而Web3应用作为一种创新的产品形态，不但要在满足用户需要上有所创新（功能性需求），还要考虑怎样在安全性和性能之间取得平衡（非功能性需求）。自诞生以来，人们提出了各种各样的解决方案试图解决性能问题。这些解决方案大致可以分为两类：一类是链上扩容方案，如分片（sharding）和有向无环图（DAG）；一类是链下扩容方案，如Plasma、闪电网络、侧链和Rollups等。但这还远远跟不上链上交易快速增长的速度。

![](/Users/likejun/Desktop/TEAM-C/Gryphsis/ga-final-report/fig1-Ethereum Trans Count & Active Wallets.png)

尤其是经历了2020年DeFi Summer以及2023年年末比特币生态中铭文的持续爆发，业界迫切需要新的性能提升方案来满足“高性能、低费率”的要求。并行EVM的新叙事就是在这样的背景下诞生的。

### 1.2 市场规模

![](/Users/likejun/Desktop/TEAM-C/Gryphsis/ga-final-report/fig2-PEVM L1 projects.png)

目前并行EVM叙事才刚刚兴起，相关叙事的项目还不多，还处于比较早期的阶段。但少数项目如Solana、Aptos和Sui眼光独到，早在另起炉灶时就提前布局了链的并行执行能力，并得到了很好的发展，代币流通市值分别达到450亿、33亿和19亿美元。Sei在其v2版本升级提案中高调宣称将成为[第一个并行EVM区块链](https://blog.sei.io/sei-v2-the-first-parallelized-evm/)，预后还有更大的发展。与其同时当下营销热度第一的并行EVM新公链Monad潜力也不可小视。几乎所有的项目都进行了不同轮次的融资活动。坊间传言Lumio近期也将公布其融资情况。从各大投资公司真金白银的用钱投票来看，并行EVM赛道值得持续关注。

![](/Users/likejun/Desktop/TEAM-C/Gryphsis/ga-final-report/fig3-PEVM vs Ethereum Ecosystems & L1.png)

总的来看，并行EVM主要项目目前代币流通市值约为523.69亿美元，24小时交易量约为31.029亿美元。其中L1项目占比最大，其代币流通市值为523亿美元，24小时交易量为31亿美元，相比之下L2项目还在早期阶段，缺少相关数据，可忽略不计。而当前EVM生态总市值约为3900亿美元，24小时交易量约为342亿美元。L1生态代币流通市值为5730亿美元，24小时交易量为288亿美元。无论是总体上与以太坊生态进行比较，还是单独观察L1项目与整个L1生态，并行EVM叙事都有很大的成长空间。而且随着进一步的发展，相信会有更多L2项目不断涌现。

###1.3 行业图谱

业界一般将区块链网络分为4层结构：

1. **Layer 0（网络）**：区块链底层网络，处理基础的网络通信协议
2. **Layer 1（基础设施）**：依赖各种共识机制对交易进行验证的去中心化网络
3. **Layer 2（扩展）**：依赖于Layer 1的各种二层协议，旨在解决Layer 1的各种局限性，尤其是可扩展性
4. **Layer 3（应用）**：依赖于Layer 2或Layer 1，用于构建各种去中心化应用（dApp）

![](/Users/likejun/Desktop/TEAM-C/Gryphsis/ga-final-report/fig4-EVM&PEVML1.png)

作为一种比较底层的技术迭代，**并行EVM叙事主要分为L1和L2两派**。一派自建L1，成为自带并行交易处理能力的新公链，**争当高性能基础设施**。另一派成为L2，通过整合其他链的能力进行扩容，**其共同的特点在于跨生态合作**。L1这一派中，以Monad和Sei v2为代表的项目自行设计并行EVM，兼容以太坊生态并提供更快速的交易处理能力。以Solana、Aptos和Sui为代表的项目则另起炉灶，成为以太坊强有力的竞争者。L2这一派中，Neon是基于Solana的EVM网络，Eclipse是可定制的模块化rollups，二者均属于Solana生态的基础设施项目。Lumio则利用Aptos执行交易并利用以太坊作为结算层，是Aptos生态中的基础设施项目。

从项目总数和几个主要赛道的发展可以看出，比起以太坊，各L1公链生态仍然存在很大的发展空间。随着版本的升级和兼容EVM的并行新公链的出现，以太坊生态本身也会得到进一步的发展。伴随着基础设施的不断完善，非EVM公链未来也会涌现出更多对并行处理能力要求更高的项目。此类项目最容易出现在对“高速低费率”有要求的DeFi领域，以及对“强实时交互”有要求的游戏领域。而并行EVM叙事必然会给这些项目带来更好的用户体验，推动行业的发展进入到全新的阶段。

![](/Users/likejun/Desktop/TEAM-C/Gryphsis/ga-final-report/fig5-Fuel Ecosystems.png)

在上述单体区块链解决方案之外，Fuel提出了自己的模块化区块链思路。它将在第二个版本中将自己定位成**未来更灵活、更彻底的模块化执行层**。Fuel专注于执行交易，而将其余部分外包给一个或多个独立层的区块链，从而实现更灵活的组合：既可以成为 L2，也可以成为 L1，甚至是侧链或状态通道。目前Fuel生态有17个项目，主要集中在DeFi、NFT和基础设施三个领域。不过只有Orally跨链预言机已投入实际应用。去中心化借贷平台Swaylend和永续合约交易平台SPARK上了测试网，其他项目还在开发中。可持续保持关注。

### 1.4 技术实现路径

要实现去中心化的交易执行，区块链网络必须履行4个职责：

* 执行：执行和验证交易
* 数据可用性：分发新区块到区块网络的所有节点
* 共识机制：验证区块，达成共识
* 结算：结算并记录交易的最终状态

**并行EVM叙事本质上是对区块链执行层的性能优化**。这又分为一层网络（L1）解决方案和二层网络（L2）解决方案两种。L1的解决方案本质上是引入并行执行机制，让区块链虚拟机的执行并行化。L2的解决方案本质上是利用已经并行化的L1虚拟机实现某种程度上的“链下执行+链上结算”，与Rollup机制异曲同工。所以要理解并行EVM的工作原理，就要将叙事拆解开来，先理解什么是虚拟机（virtual machine）以及什么是并行执行（parallel execution）。

#### 1.4.1 虚拟机

在计算机科学中，虚拟机是指对计算机系统进行的虚拟（virtualization）或者模拟（emulation）。虚拟机分为两种，一种叫系统虚拟机（system virtual machine），可以将一台物理机虚拟化为多台机器，运行多个操作系统，从而提高资源利用率。另一种叫进程虚拟机（process virtual machine），为某些高级编程语言提供抽象，让使用这种语言编写的计算机程序以一种平台无关的方式运行在不同平台上。JVM就是一种为Java编程语言设计的进程虚拟机。Java语言编写的程序首先被编译成Java字节码（一种中间状态的二进制代码），Java字节码由JVM解释执行：JVM将字节码送给解释器，由解释器翻译成不同机器上的机器码，然后在机器上运行。

区块链虚拟机是进程虚拟机的一种。在区块链的语境下，虚拟机是指对分布式状态机进行的虚拟，用于分布式地执行合约，运行dApp。类比JVM，EVM就是一种为Solidity语言设计的进程虚拟机，智能合约首先被编译成opcode字节码，然后由EVM解释执行。

以太坊之外的新兴公链在实现自己的虚拟机时，更多采用的是基于wasm或eBPF字节码的虚拟机。WASM是一种体积小、加载快、可移植且基于沙盒安全机制的字节码格式，开发人员可以使用多种编程语言（C、C++、Rust、Go、Python、Java甚至TypeScript等）编写智能合约，然后编译成wasm字节码并执行。Sei公链上执行的智能合约正是采用了这一字节码格式。

eBPF前身是BPF（Berkeley Packet Filter，伯克利包过滤器），原本是用于网络数据包的高效过滤，后经过演化形成了eBPF，提供更丰富的指令集。它是一项允许在不改动源码的情况下对操作系统内核进行动态干预和修改其行为的革命性技术。后来这项技术从内核中走出来，发展出了用户态eBPF运行时，其具有高性能、安全和可移植性。在Solana上执行的智能合约都会编译成eBPF字节码并在其区块链网络上运行。

而其他的L1公链中，Aptos和Sui使用Move智能合约编程语言，编译成特有的Move字节码在Move虚拟机上执行。Monad则自行设计了兼容EVM opcode字节码（Shanghai fork）的虚拟机。

概述

虚拟机的作用

并行执行

​	交易依赖性

​	消息传递模型

​	共享内存模型

​		内存锁

​		乐观并行化

​	优缺点分析

Solana的SeaLevel技术

Sui的对象内存模型

Monad静态代码分析

Neon：运行在Solana虚拟机上的EVM模拟器

Eclipse：SVM执行，EVM结算

Lumio：双虚拟机支持

Fuel：基于UTXO模型的并行处理

###1.5 行业增长驱动力

## 2 标的梳理

## 3 结论与展望

为牛市做准备





